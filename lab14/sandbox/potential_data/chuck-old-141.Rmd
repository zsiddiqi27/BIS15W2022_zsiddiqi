---
title: "Data Visualization: fancy plots"
output:
  html_document:
    theme: spacelab
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
---

## Learning Goals
*At the end of this exercise, you will be able to:*    
1. Build a violin plot using.
2. Build heat maps using `ggplot.`




## Setup


### install packages
```{r}

###Hannah, delete polypath
#install.packages("ggpolypath")



#install.packages("ggVennDiagram")
```

### Load the libraries
```{r message=FALSE, warning=FALSE}
library(tidyverse)

library(janitor)
library(here)
library(palmerpenguins)

#hannah delete ggpp
#library(ggpolypath)

library(ggVennDiagram)
```

```{r}
options(scipen=999) #cancels the use of scientific notation for the session
```

## Venn


### homerange 
```{r}
homerange <- read_csv(here("data", "Tamburelloetal_HomeRangeDatabase.csv"))

homerange %>%
#  summarize(n=n_distinct(taxon))
  distinct(taxon)

homerange %>%
  distinct(locomotion)

subset_homerange <- homerange %>%
  filter(taxon =="mammals" | taxon == "birds" | taxon == "turtles")
subset_homerange

```
### super heros venn
```{r}
superhero_info <- readr::read_csv("data/heroes_information.csv", na = c("", "-99", "-"))%>%
  clean_names()

evil_vec <- superhero_info %>%
  filter(alignment == "bad")%>%
  pull(name)

red_eye_vec <- superhero_info %>%
  filter(eye_color == "red")%>%
  pull(name)

male_vec <- superhero_info %>%
  filter(gender == "Male")%>%
  pull(name)

bald_vec <- superhero_info%>%
  filter(hair_color == "No Hair")%>%
  pull(name)
  

venn_diag_category_list_2 <- list(evil_vec, red_eye_vec)
ggVennDiagram(venn_diag_category_list_2, category.names = c("Evil", "Red Eyes"))

venn_diag_category_list_3 <- list(evil_vec, red_eye_vec, male_vec)
ggVennDiagram(venn_diag_category_list_3, category.names = c("Evil", "Red Eyes", "Male"))

venn_diag_category_list_4 <- list(evil_vec, red_eye_vec, male_vec, bald_vec)
ggVennDiagram(venn_diag_category_list_4, category.names = c("Evil", "Red Eyes", "Male", "Bald"))
```



#### cleaning up venns
[great info here](https://cran.r-project.org/web/packages/ggVennDiagram/vignettes/using-ggVennDiagram.html)
```{r}
feature_list <- list(evil_vec, red_eye_vec, male_vec)

#library(RColorBrewer)
#library(ggthemes)

ggVennDiagram(feature_list,
              category.names = c("Evil", "Red Eyes", "Male"),
              edge_size = 1
              )+
  scale_fill_distiller(palette = "GnBu")+
  scale_color_brewer(palette = "Greys") + 
  labs(title = "Four sets Venn Diagram",
         subtitle = "generated by `ggVennDiagram`",
         caption = ("you can add a caption here, like the date")
  )


###
#ggVennDiagram(feature_list,
#              edge_lty = "dashed",              # Changes border line-type
#              edge_size = 1,
#              category.names = c("Evil", "Red Eyes", "Male")
#              )+
#  scale_fill_distiller(palette = "RdBu") +      # Changes fill of circles
#  scale_color_brewer(palette = "BuPu") +        # Changes border color
  
```

```{r}
              category.names = c("Evil", "Red Eyes", "Male"), 
              show_intersect = TRUE)


ggVennDiagram(venn_diag_category_list_3, 
              category.names = c("Evil", "Red Eyes", "Male")+
              scale_fill_brewer(palette = "BuPu")+, 
              show_intersect = TRUE,
              fill)+
              guides(fill = "BuPu") +
#              color = "black", 
#              fill = "BuPu",
              theme(legend.title = element_text(color = "red"), legend.position = "bottom")
              
#  guides(fill = guide_legend(title = "num observations")) +
  theme(legend.title = element_text(color = "red"), legend.position = "bottom")

###



ggVennDiagram(venn_diag_category_list_3, category.names = c("Evil", "Red Eyes", "Male"), show_intersect = TRUE)



#my_pallete <- brewer.pal(5, GnBu)

#ggVennDiagram(venn_diag_category_list_3, color = "black", lwd = 0.8, lty = 1) + 
#  scale_fill_gradient(low = "#F4FAFE", high = "#4981BF")

ggVennDiagram(venn_diag_category_list_3, color = "black", fill = my_pallete) + 
#  guides(fill = guide_legend(title = "num observations")) +
  theme(legend.title = element_text(color = "red"), legend.position = "bottom")

```

So like, how do you make a venn diagram? what are they actually good for?
One useful place-- 2 factoral catagories with more than 2 factors each.

So looking at the hr data, there are 9 taxa. for simplicity, lets select 3. 

so among birds, mammals, and turtles, there is a mix of walking swimming and flying. 
how do the species in these categories fall into these locomotive cats?




### homerange ven

```{r}
homerange <- read_csv(here("data", "Tamburelloetal_HomeRangeDatabase.csv"))

#homerange %>%
#  summarize(n=n_distinct(taxon))
#  distinct(taxon)
#  distinct(locomotion)

#update home range:

head(homerange)
```
```{r}

homerange_ver2 <-  homerange %>%
  add_row(taxon = "mammal", common.name == "bat", locomotion == "flying", trophic.guild == "omnivore")



# are there bats in this data?
bird_vec <- homerange %>%
  filter(taxon =="birds")%>%
  pull(common.name)

flighted_vec <- homerange %>%
  filter(locomotion == "flying")%>%
  pull(common.name)

venn_diag_category_list <- list(fly = flighted_vec, bird = bird_vec)
ggVennDiagram(venn_diag_category_list, category.names = c("Flighted", "A Bird"))



```




```{r}
library(venn)



#venn(gene_list)




library(ggVennDiagram)

genes <- paste0("gene",1:1000)
set.seed(20210302)
gene_list <- list(A = sample(genes,100),
                  B = sample(genes,200),
                  C = sample(genes,300),
                  D = sample(genes,200))


p1 <- ggVennDiagram(gene_list, 
                    category.names = c("a very long name","short name","name","another name"))
p1
```


















### Violin Plots
Violin plots show the distribution of continuous data across a categorical variable.
Violin plots are a lot like a density plots, often displayed vertically. They are nice for comparing among groups, and are common in publications. 


### life_history
Let's revisit the mammal life history data to practice our ggplot skills. The [data](http://esapubs.org/archive/ecol/E084/093/) are from: *S. K. Morgan Ernest. 2003. Life history characteristics of placental non-volant mammals. Ecology 84:3402.*

```{r message=FALSE, warning=FALSE}
#life_history <- read_csv(here("data", "mammal_lifehistories_v2.csv")) %>% na_if("-999") %>% clean_names()
```






### life hist data
lets remind ourselves of the structure of the `life_history` data:

```{r}
#str(life_history)
```

```{r}
#head(life_history)
```



















-----------










```{r}
qpcr_untidy <- read_csv("data/qpcr_untidy.csv")
```


# Part 2 

We will also use this
[Homerange](http://datadryad.org/resource/doi:10.5061/dryad.q5j65/1). The data are from: Tamburello N, Cote IM, Dulvy NK (2015) Energy and the scaling of animal space use. The American Naturalist 186(2):196-211. http://dx.doi.org/10.1086/682070.  


